<div class="container margin-top">
    <div class="card-bg d-flex flex-column justify-content-center align-items-center">
        <div class="card bg-dark">
            <h3 for="exampleFormGroup">Cadastrar jogo</h3>
            <div class="card-body d-flex flex-column justify-content-center align-items-center">
                <form [formGroup]="gameFormGroup" (ngSubmit)="onSubmitCriarJogo()">
                    <div class="form-group">
                        <label class="placeholder">Nome</label>
                        <input formControlName='nome' type="text" class="form-control" id="exampleNome"
                            aria-describedby="nicknameHelp" placeholder="Nome">
                        <app-error-card
                            *ngIf="gameFormGroup.get('nome').hasError('required') && gameFormGroup.get('nome').touched"
                            [mensagem]="'O campo nome é obrigatório'"></app-error-card>
                        <app-error-card
                            *ngIf="gameFormGroup.get('nome').hasError('maxlength') && gameFormGroup.get('nome').touched"
                            [mensagem]="'O campo nome só pode ter no máximo 50 caracteres'"></app-error-card>
                    </div>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">R$</span>
                        </div>
                        <input formControlName='preco' type="number" class="form-control" placeholder="Preço">
                        <div class="input-group-append">
                            <span class="input-group-text">,00</span>
                        </div>
                    </div>
                    <app-error-card
                        *ngIf="gameFormGroup.get('preco').hasError('required') && gameFormGroup.get('preco').touched"
                        [mensagem]="'O campo preço é obrigatório'"></app-error-card>
                    <div class="form-group">
                        <label class="placeholder">Data de lançamento</label>
                        <input formControlName='dataLancamento' type="date" class="form-control" id="exampleInputEmail1"
                            aria-describedby="emailHelp" placeholder="Data de lançamento">
                        <app-error-card
                            *ngIf="gameFormGroup.get('dataLancamento').hasError('required') && gameFormGroup.get('dataLancamento').touched"
                            [mensagem]="'O campo data de lançamento é obrigatório'"></app-error-card>
                        <app-error-card
                            *ngIf="gameFormGroup.get('dataLancamento').hasError('pattern') && gameFormGroup.get('dataLancamento').touched"
                            [mensagem]="'O campo data está com formato errado - dd/MM/YYYY'"></app-error-card>
                    </div>
                    <div class="form-group">
                        <label class="placeholder">Desenvolvedor</label>
                        <input formControlName='desenvolvedor' type="text" class="form-control"
                            id="exampleInputDesenvolvedor" placeholder="Desenvolvedor">
                        <app-error-card
                            *ngIf="gameFormGroup.get('desenvolvedor').hasError('required') && gameFormGroup.get('desenvolvedor').touched"
                            [mensagem]="'O campo desenvolvedor é obrigatório'"></app-error-card>
                        <app-error-card
                            *ngIf="gameFormGroup.get('desenvolvedor').hasError('maxlength') && gameFormGroup.get('desenvolvedor').touched"
                            [mensagem]="'O campo desenvolvedor só pode ter no máximo 45 caracteres'"></app-error-card>
                    </div>
                    <div class="form-group">
                        <label>Descrição</label>
                        <textarea formControlName='descricao' type="text" class="form-control"
                            id="exampleInputDescricao" placeholder="Descrição"></textarea>
                        <app-error-card
                            *ngIf="gameFormGroup.get('descricao').hasError('required') && gameFormGroup.get('descricao').touched"
                            [mensagem]="'O campo descrição é obrigatório'"></app-error-card>
                        <app-error-card
                            *ngIf="gameFormGroup.get('descricao').hasError('minlength') && gameFormGroup.get('descricao').touched"
                            [mensagem]="'O campo descricao precisar ter no mínimo 6 caracteres'"></app-error-card>
                        <app-error-card
                            *ngIf="gameFormGroup.get('descricao').hasError('maxlength') && gameFormGroup.get('descricao').touched"
                            [mensagem]="'O campo descricao só pode ter no máximo 500 caracteres'"></app-error-card>
                    </div>
                    <div>
                        <div class="input-group">
                            <select formControlName='categoria' class="custom-select" id="inputGroupSelectCategoria">
                                <option *ngFor="let categoria of categorias" [value]="categoria.id">{{ categoria.nome }}
                                </option>
                            </select>
                            <div class="input-group-append">
                                <label class="input-group-text" for="inputGroupSelectCategoria">Categoria </label>
                                <label class="input-group-text" for="inputGroupSelectCategoria"><span class="pointer"
                                        *ngIf="categorias.length != 0" data-toggle="modal"
                                        data-target="#criarCategoria">Adicionar</span></label>
                            </div>
                        </div>
                        <app-error-card
                            *ngIf="gameFormGroup.get('categoria').hasError('required') && gameFormGroup.get('categoria').touched"
                            [mensagem]="'O campo categoria é obrigatório'"></app-error-card>
                        <app-error-card *ngIf="categorias.length == 0 && this.categoriasLoading == false"
                            data-toggle="modal" data-target="#criarCategoria"
                            [mensagem]="'Nenhuma categoria registrada - clique para criar'" class="pointer">
                        </app-error-card>
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">Upload</span>
                        </div>
                        <div class="custom-file">
                            <input (change)="onUploadCapa($event)" type="file" accept="image/*"
                                class="custom-file-input" id="inputGroupFile01"
                                aria-describedby="inputGroupFileAddon01">
                            <label class="custom-file-label" for="inputGroupFile01">{{ file | fileName }}</label>
                        </div>
                    </div>
                    <ngx-alerts></ngx-alerts>
                    <button type="submit" [disabled]='!gameFormGroup.valid || loading == true || file == null'
                        class="btn btn-primary float-right">CADASTRAR <i *ngIf="loading == true"
                            class="fas fa-spinner fa-pulse i-right"></i></button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="criarCategoria" tabindex="-1" role="dialog" aria-labelledby="CriarCategoria"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content bg-dark">
            <div class="modal-header">
                <h5 class="modal-title" id="TituloModalCentralizado">Criar categoria</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span class="close-modal" aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <app-category-cadastre (atualizarLista)="atualizarList($event)"></app-category-cadastre>
            </div>
        </div>
    </div>
</div>